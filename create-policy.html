<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Create Policy Set — Demo</title>

  <!-- shared nav style -->
  <link rel="stylesheet" href="./nav.css">

  <style>
    :root{
      --navw:240px;
      --bg:#fff;
      --line:#111;
      --line2:#e6e6e6;
      --muted:#666;
      --radius:14px;
      --gap:14px;
      --accent:#111;
      --primary-bg:#111;
      --primary-fg:#fff;
      --card-bg:#fff;
      --shadow: 0 10px 30px rgba(0,0,0,.06);
      --sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }

    *{box-sizing:border-box}
    body{margin:0; font-family:var(--sans); background:var(--bg); color:var(--line); min-height:100vh;}

    /* mount for injected nav */
    #leftNavMount{position:fixed; left:0; top:0; bottom:0; width:var(--navw); z-index:60;}

    /* page layout */
    .content{margin-left:var(--navw); min-height:100vh;}
    .topbar{position:sticky; top:0; background:var(--bg); border-bottom:2px solid var(--line2); padding:12px 18px; z-index:40;}
    .topRow{display:flex; align-items:center; justify-content:space-between;}
    .objTitle{font-weight:900; font-size:18px}
    .objSub{font-size:12px; color:var(--muted); margin-top:4px}

    main.page{padding:18px; padding-bottom:120px}

    /* layout for wizard content */
    .wizardGrid{display:grid; grid-template-columns:320px 1fr; gap:18px; align-items:start}
    .card{background:var(--card-bg); border:2px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden}
    .card.pad{padding:12px}

    /* stepper left */
    #stepper{padding:12px; height:calc(100vh - 180px); overflow:auto}
    .stepItem{display:flex; gap:12px; align-items:flex-start; padding:10px; border-radius:10px; cursor:pointer; border:2px solid transparent}
    .stepItem:hover{border-color:var(--line2)}
    .stepItem .num{width:28px;height:28px;border-radius:6px;border:2px solid var(--line2);display:flex;align-items:center;justify-content:center;font-weight:900;color:var(--muted);flex:0 0 28px}
    .stepItem.active{border-color:var(--line); background:#fff; color:var(--line)}
    .stepItem.done .num{border-color:var(--line); background:#fff; color:var(--line)}

    /* main step content */
    #stepContent{padding:18px; min-height:320px}
    #stepContent h2{margin:0 0 8px; font-size:18px; font-weight:900}
    #stepContent p{margin:0; color:var(--muted)}

    /* upload box */
    .uploadBox{
      border:2px dashed var(--line2);
      border-radius:12px;
      padding:18px;
      background:linear-gradient(180deg,#fff,#fbfbfb);
    }
    .uploadRow{display:flex;justify-content:space-between;align-items:center;gap:12px}
    .fileName{font-weight:900;color:var(--line)}

    /* details and kv rows */
    .details{display:flex;flex-direction:column;gap:10px}
    .detailRow{display:flex;gap:12px;align-items:center;padding:10px;border-radius:10px;border:1px solid var(--line2);background:#fff}
    .detailRow .key{width:180px;font-weight:800;color:var(--muted);font-size:13px}
    .detailRow .value{flex:1;font-weight:700;color:var(--line);font-size:13px}

    .detailTable{width:100%;border-collapse:collapse;margin-top:8px}
    .detailTable th,.detailTable td{border:1px solid #eee;padding:10px 12px;text-align:left;font-size:13px}
    .detailTable th{background:#fafafa;font-weight:900}

    .smallMuted{font-size:12px;color:var(--muted);font-weight:700}
    .sectionNote{font-size:13px;color:var(--muted);margin-top:6px}

    /* buttons */
    .btn{border:2px solid var(--line); background:#fff; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:900}
    .btn:hover{background:#f7f7f7}
    .btn.primary{background:var(--primary-bg);color:var(--primary-fg)}
    .btn.quiet{background:#f7f7f7}

    /* sticky bottom bar, right-aligned, avoids nav */
    .stickybar{position:fixed; left:var(--navw); right:0; bottom:0; z-index:99; background:var(--bg); border-top:2px solid var(--line2); padding:14px 20px; box-shadow:0 -8px 18px rgba(0,0,0,.06)}
    .stickyInner{display:flex; justify-content:flex-end; gap:12px; align-items:center; max-width:1200px; margin:0 auto}

    /* drawer + toast */
    #drawerOverlay{position:fixed; inset:0; display:none; background:rgba(0,0,0,.12); z-index:150; align-items:stretch}
    #drawer{margin-left:auto;width:480px;background:#fff;border-left:2px solid var(--line);height:100%;display:flex;flex-direction:column}
    #drawerHeader{padding:12px;border-bottom:2px solid var(--line)}
    #drawerContent{padding:12px;overflow:auto;flex:1}
    #toast{position:fixed; left:calc(var(--navw) + 18px); bottom:92px; display:none; z-index:160; padding:10px 12px; border:2px solid var(--line); background:#fff; border-radius:10px; font-weight:900}

    @media (max-width:980px){
      .wizardGrid{grid-template-columns: 1fr;}
      #leftNavMount{position:static;width:auto}
      .content{margin-left:0}
      .stickybar{left:0}
    }
  </style>
</head>
<body data-nav="policy-sets">
  <!-- left nav mount (nav.html gets injected here) -->
  <div id="leftNavMount"></div>

  <div class="content">
    <div class="topbar">
      <div class="topRow">
        <div>
          <div class="objTitle">Create Policy Set</div>
          <div class="objSub">Wizard prototype — polished demo</div>
        </div>
      </div>
    </div>

    <main class="page">
      <section id="wizard" class="screen">
        <div class="wizardGrid">
          <!-- left stepper -->
          <aside class="card" id="stepper">
            <!-- step items injected by JS -->
          </aside>

          <!-- right main card -->
          <section class="card">
            <div id="stepContent">
              <!-- content injected by JS -->
            </div>
          </section>
        </div>
      </section>
    </main>
  </div>

  <!-- sticky bottom actions -->
  <div id="sticky" class="stickybar">
    <div class="stickyInner">
      <button class="btn quiet" id="backBtn" onclick="back()">Back</button>
      <button class="btn quiet" id="skipBtn" onclick="skip()">Skip (manual)</button>
      <button class="btn primary" id="nextBtn" onclick="next()">Next</button>
    </div>
  </div>

  <!-- drawer + toast placeholders -->
  <div id="drawerOverlay" onclick="closeDrawer(event)">
    <aside id="drawer" aria-label="Drawer">
      <div id="drawerHeader"><div style="font-weight:900">Details</div><button class="btn quiet" onclick="hideDrawer();event.stopPropagation()">Close</button></div>
      <div id="drawerContent"></div>
    </aside>
  </div>
  <div id="toast"></div>

  <!-- inject nav -->
  <script>
  (async function loadNav(){
    const mount = document.getElementById('leftNavMount');
    if(!mount) return;
    try{
      const res = await fetch('./nav.html', {cache:'no-store'});
      mount.innerHTML = await res.text();
      // highlight active item
      const active = document.body.getAttribute('data-nav');
      if(active){
        mount.querySelectorAll('.navItem').forEach(a => a.classList.toggle('active', a.dataset.nav === active));
      }
    }catch(e){
      console.warn('Could not load nav.html', e);
    }
  })();
  </script>

  <!-- Lightweight stepper + rendering logic -->
  <script>
  // tiny helpers
  function $(id){ return document.getElementById(id); }
  function el(tag,attrs={},html=''){ const e=document.createElement(tag); for(let k in attrs) e.setAttribute(k, attrs[k]); if(html) e.innerHTML=html; return e; }

  // Demo steps + static content (polished)
  const steps = [
    {id:'method', title:'Method', short:'1'},
    {id:'document', title:'Document', short:'2'},
    {id:'analyze', title:'Analyze', short:'3'},
    {id:'regscope', title:'Regulatory scope', short:'4'},
    {id:'regtasks', title:'Regulatory tasks', short:'5'},
    {id:'orgtasks', title:'Organizational tasks', short:'6'},
    {id:'summary', title:'Summary', short:'7'}
  ];
  let state = {index:0};

  function renderStepper(){
    const mount = $('stepper');
    mount.innerHTML = '';
    steps.forEach((s,i) => {
      const item = el('div',{class:'stepItem' + (i===state.index?' active':'') + (i<state.index ? ' done':'')});
      item.onclick = ()=>{ state.index=i; renderStepper(); renderStep(); };
      const num = el('div',{class:'num'}, s.short);
      const label = el('div',{}, `<div style="font-weight:900">${s.title}</div>`);
      item.appendChild(num); item.appendChild(label);
      mount.appendChild(item);
    });
  }

  function renderStep(){
    const mount = $('stepContent');
    const s = steps[state.index];
    // build content per step
    if(!mount) return;
    if(s.id === 'method'){
      mount.innerHTML = `
        <div style="display:flex;gap:18px;align-items:flex-start">
          <div style="flex:1">
            <h2>Choose a method</h2>
            <p class="smallMuted">How would you like to create this Policy Set?</p>
            <div style="margin-top:12px" class="details">
              <div class="detailRow"><div class="key">Start from document</div><div class="value">Upload carrier contract or policy (recommended)</div></div>
              <div class="detailRow"><div class="key">Create manually</div><div class="value">Enter tasks & scope manually</div></div>
            </div>
          </div>
          <div style="width:360px">
            <div class="detailRow"><div class="key">Selected method</div><div class="value">Start from document</div></div>
            <div style="margin-top:10px" class="smallMuted">Tip: Upload a PDF and we’ll extract scope & tasks automatically.</div>
          </div>
        </div>
      `;
    } else if(s.id === 'document'){
      mount.innerHTML = `
        <div>
          <h2>Upload source document</h2>
          <p class="smallMuted">Drop a file to generate an initial Policy Set draft.</p>

          <div style="margin-top:14px" class="uploadBox">
            <div class="uploadRow">
              <div>
                <div class="fileName">PDF — Carrier A contract.pdf</div>
                <div class="smallMuted">Already added · Replace or remove</div>
              </div>
              <div style="display:flex;gap:8px">
                <button class="btn quiet" onclick="replaceFile()">Replace</button>
                <button class="btn quiet" onclick="removeFile()">Remove</button>
              </div>
            </div>
            <div style="margin-top:12px" class="smallMuted">Supported: PDF, DOCX (max 25MB)</div>
          </div>

          <div style="margin-top:12px" class="card pad">
            <h3 style="margin:0 0 8px">What we'll extract</h3>
            <p class="smallMuted">States · Products · Licenses / LOAs · Carrier rules & requirements</p>
            <div style="margin-top:8px">
              <button class="btn quiet" onclick="skipAndEnter()">Skip and enter scope manually</button>
            </div>
          </div>

          <div style="margin-top:14px">
            <h3 style="margin:0 0 8px">Extracted Regulatory Scope</h3>
            <table class="detailTable">
              <thead><tr><th>State/Area</th><th>Products</th><th>Notes</th></tr></thead>
              <tbody>
                <tr><td>California</td><td>Life, Annuity</td><td>Requires LOA for transactions</td></tr>
                <tr><td>Texas</td><td>Life</td><td>Carrier-specific licensing rules apply</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      `;
    } else if(s.id === 'analyze'){
      mount.innerHTML = `
        <div>
          <h2>Analyze document</h2>
          <p class="smallMuted">We analyzed the uploaded document and proposed these regulatory tasks and organizational tasks.</p>

          <table class="detailTable" style="margin-top:12px">
            <thead><tr><th>Task</th><th>Type</th><th>Suggested Assignee</th></tr></thead>
            <tbody>
              <tr><td>Verify LOA acceptability</td><td>Regulatory</td><td>Compliance</td></tr>
              <tr><td>Update producer appointment rules</td><td>Organizational</td><td>Ops</td></tr>
            </tbody>
          </table>
        </div>
      `;
    } else {
      mount.innerHTML = `<div style="padding:12px"><h2>${s.title}</h2><p class="smallMuted">This step is a prototype placeholder. Replace or extend with your flow content.</p></div>`;
    }

    // show/hide sticky buttons depending on step
    const back = $('backBtn'), skip = $('skipBtn'), next = $('nextBtn');
    if(back) back.disabled = (state.index===0);
    if(skip) skip.style.display = (s.id==='document' ? 'inline-flex' : 'none');
    if(next) next.textContent = (state.index === steps.length -1 ? 'Finish' : 'Next');
  }

  // navigation functions
  function next(){
    if(state.index < steps.length - 1){ state.index++; renderStepper(); renderStep(); window.scrollTo(0,0); }
    else { finish(); }
  }
  function back(){
    if(state.index > 0){ state.index--; renderStepper(); renderStep(); window.scrollTo(0,0); }
  }
  function skip(){ state.index++; renderStepper(); renderStep(); }
  function replaceFile(){ alert('Replace file - demo only'); }
  function removeFile(){ alert('Remove file - demo only'); }
  function skipAndEnter(){ alert('Skip and enter scope manually - demo only'); }

  function finish(){ alert('Finish — demo complete'); }

  // startup
  document.addEventListener('DOMContentLoaded', ()=>{
    renderStepper();
    renderStep();
    // make sure sticky visible
    const st = $('sticky'); if(st) st.style.display = 'block';
  });
  </script>
</body>
</html>
